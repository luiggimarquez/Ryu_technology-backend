<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Productos</title>
    <link rel="stylesheet" href="../../styles.css">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-GLhlTQ8iRABdZLl6O3oVMWSktQOp6b7In1Zl3/Jr59b6EGGoI1aFkw7cmDA6j6gD" crossorigin="anonymous">
    

</head>
<body id="body">
    
    <header>
        <div class="headerTitle"><a href="/"><h1>Ryu Technology</h1></a></div><div class="iconCart"><a href="/carrito/cartPreview"><img src="../images/cart.png" alt="acceso al carrito"></a></div>
        <div class="templateUserloged"><h2> --- <%= name %>  --- <%= email %></h2><button class="buttonLogout" onclick="location.href='/logout'">Logout</button></div>
    </header>


    <main class="orders">

        <% if(result.length !== 0){ %> 

            <h1 class="ordersTitle">Hola, <%= name %>, Estas son sus ordenes registradas:</h1>

            <div class="orderContainer">

                            <% result.forEach(x =>{ %>

                                <h3 class="dateOrders">Fecha de compra: <%= x.timestamp %></h3>
                    <table>

                        <thead>
                            <tr>
                                <th colspan="5">Orden de Compra</th>
                            </tr>
                        </thead>
                
                            <tbody>
        
                                
                                    
                                    <tr>
                                        <td colspan="3"><p class="pOrder">ID compra</p></td>
                                        <td colspan="2"><p class="pOrder"><%= x.id %> </p></td>
                                    </tr>
                                    <tr> 
                                        <td colspan="3"><p class="pOrder">Cliente</p></td>
                                        <td colspan="2"><p class="pOrder"><%= x.userName %> <%=x.userLastName %></p></td>
                                    </tr>
                                    <tr>
                                        <td colspan="3"><p class="pOrder">Email</p></td>
                                        <td colspan="2"><p class="pOrder"><%= x.email %></p></td>
                                    </tr>
                                    <tr>
                                        <td colspan="3"><p class="pOrder">Telefono</p></td>
                                        <td colspan="2"><p class="pOrder"><%= x.phone %></p></td>
                                    </tr>
                                    <tr>
                                        <td colspan="3"><p class="pOrder">direccion de Entrega</p></td>
                                        <td colspan="2"><p class="pOrder"> <%= x.address %></p></td>
                                    </tr>
                                    
                            </tbody>
                        </table>
                        <table>
                            <tbody>
                                    <tr>
                                        <th colspan="1"><p class="pOrder">  Producto  </p></th>
                                        <th colspan="1"><p class="pOrder">  Descripcion  </p></th>
                                        <th colspan="1"><p class="pOrder">  Precio  </p></th>
                                        <th colspan="1"><p class="pOrder">  Cantidad  </p></th>
                                        <th colspan="1"><p class="pOrder">  subtotal  </p></th>
                                    </tr>

                                    <% x.products.forEach(y =>{ %>
                                        
                                        
                                        <tr>
                                            <td><p class="pOrder"> <%= y.name %> </p></td>
                                            <td><p class="pOrder"> <%= y.description %> </p></td>
                                            <td><p class="pOrder"> <%= y.price %> </p></td>
                                            <td><p class="pOrder"> <%= y.quantity %> </p></td>
                                            <td><p class="pOrder"> <%= y.quantity * y.price%> $USD </p></td>
                                        </tr>
                                        

                                    <% }) %>
                                    <tr>
                                        <td colspan="5"><p style="text-align: end;" class="pOrder"> SubTotal a Pagar: <%= x.totalPay / 1.21 %> $USD</p></td>
                                    </tr>
                                    <tr>
                                        <td colspan="5"><p  style="text-align: end;" class="pOrder"></p></td>
                                    </tr>
                                    <tr>
                                        <td colspan="5"><p  style="text-align: end;" class="pOrder">Total a Pagar: <%= x.totalPay%> $USD</p></td>
                                    </tr>

                                    
                                </tbody>
                            </table>
                            
                            <% }) %>
            </div>
            
        <% }else{ %>

            <h1>No tienes órdenes registradas</h1>

        <% } %>

    </main>
    

    <footer class="footer"><h4>Ryu Technology || © All right Reserved</h4></footer>
    
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js" integrity="sha384-w76AqPfDkMBDXo30jS1Sgez6pr3x5MlQ1ZAGC+nuZB+EYdgRZgiwxhTBTkF7CXvN" crossorigin="anonymous"></script>

</body>
</html>